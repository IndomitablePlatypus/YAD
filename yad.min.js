function isCallable(t){return"[object Function]"===Object.prototype.toString.call(t)}function getUUID(){return"xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx".replace(/[x]/g,function(){var t=16*Math.random()|0;return t.toString(16)})}function thereis(t){return"undefined"!=typeof t}function iselse(t,e){return thereis(t)?t:isCallable(e)?e():e}var YAD={_dispatcher:void 0,getDispatcher:function(){return thereis(this._dispatcher)?this._dispatcher:this._dispatcher=new this.Dispatcher},createEvent:function(t,e){return new this.Event(t,e)},createListener:function(t,e,n){return new this.Listener(t,e,n)},Dispatcher:function(){return this instanceof YAD.Dispatcher?this:this.getDispatcher()},Event:function(t,e){this._parse(t,e)},Listener:function(t,e,n){this._parse(t,e,n)},yell:function(t,e,n){return this.getDispatcher().say(t,e,n)},whisper:function(t,e,n){return this.getDispatcher().say(t,e,n,!1)},listen:function(t,e,n){return this.getDispatcher().listen(t,e,n)}};YAD.Dispatcher.prototype={_delay:0,_dispatchMode:!0,_eventListeners:[],_listeners:[],_createEvent:function(t,e){return YAD.createEvent(t,e)},_isEventObject:function(t){return t instanceof YAD.Event},_prepareEvents:function(t,e){var n=[];if(this._isEventObject(t))t.setData(e),n.push(t);else{var i=t.split("."),s=i[0];n.push(this._createEvent(s,e));for(var r=1;r<i.length;r++)s=s+"."+i[r],n.unshift(this._createEvent(s,e))}return n},_parseListenerInfo:function(t,e){return t instanceof YAD.Listener?t:Array.isArray(t)?t.length>=2?YAD.createListener(t[0],t[1]):YAD.createListener(t[0],e):YAD.createListener(t,e)},_prepareListeners:function(t,e){var n=[];if(!Array.isArray(t))return n.push(this._parseListenerInfo(t,e)),n;for(var i=0;i<t.length;i++)n.push(this._parseListenerInfo(t[i],e));return n},_prepareListenerNames:function(t){var e=[];e=Array.isArray(t)?t:[t];for(var n=0;n<e.length;n++)"string"!=typeof e[n]&&(e[n]=e[n].toString());return e},_runListeners:function(t,e){for(var n in t)if(t.hasOwnProperty(n)&&(t[n].invoke(e),e.isStopped()))break;return this},_dispatch:function(t){for(var e=this._eventListeners,n=0;n<t.length;n++){var i=t[n].getName();e.hasOwnProperty(i)&&this._runListeners(e[i],t[n])}return this},_addListener:function(t,e){return this._listeners[e.getName()]=e,this._eventListeners.hasOwnProperty(t.getName())||(this._eventListeners[t.getName()]=[]),this._eventListeners[t.getName()][e.getName()]=e,this},_removeListener:function(t){thereis(this._listeners[t])&&delete this._listeners[t];for(var e in this._eventListeners)this._eventListeners.hasOwnProperty(e)&&thereis(this._eventListeners[e][t])&&delete this._eventListeners[e][t];return this},say:function(t,e,n,i){if(!thereis(t))return void 0;i=iselse(i,this._dispatchMode);var s=this._prepareEvents(t,e);return i?this._dispatch(s):setTimeout(function(t){this._dispatch(t)}.bind(this),this._delay,s),thereis(n)?n(s):!0},listen:function(t,e,n){for(var i=this._prepareEvents(t),s=this._prepareListeners(e,n),r=0;r<s.length;r++)this._addListener(i[0],s[r]);return this},unlistenListener:function(t){for(var e=this._prepareListenerNames(t),n=0;n<e.length;n++)this._removeListener(e[n]);return this},unlistenEvent:function(t){var e=this._prepareEvents(t);return thereis(this._eventListeners[e[0].getName()])&&delete this._eventListeners[e[0].getName()],this},unlistenEventHeap:function(t){var e=this._prepareEvents(t);for(var n in this._eventListeners)this._eventListeners.hasOwnProperty(n)&&0===n.indexOf(e[0].getName()+".")&&delete this._eventListeners[n];return this},configure:function(t,e){return this._delay=iselse(t,0),this._dispatchMode=iselse(e,!0),this}},YAD.Event.prototype={_name:"exclamation",_data:{},_stopped:!1,_parse:function(t,e){return this.setName(t).setData(e),this},setCarryOn:function(t,e){return this._data[t]=e,this},setName:function(t){return this._name=iselse(t,this._name),this},setData:function(t){return this._data=iselse(t,this._data),this},stopPropagation:function(){return this._stopped=!0,this},stop:function(){return this.stopPropagation()},isStopped:function(){return this._stopped},getName:function(){return this._name},getData:function(){return this._data}},YAD.Listener.prototype={_name:void 0,_executor:void 0,_context:void 0,_parse:function(t,e,n){return this.setExecutor(t).setContext(e).setName(n),this},setName:function(t){return this._name=iselse(t,this._name),this},setExecutor:function(t){return this._executor=t,this._name=iselse(this._name,this._executor.toString()),this},setContext:function(t){return this._context=iselse(t,window),this},getName:function(){return this._name},getExecutor:function(){return this._executor},getContext:function(){return this._context},isViable:function(){return isCallable(this._executor)},invoke:function(t){return this.isViable()?this._executor.call(this._context,t):void 0}};
